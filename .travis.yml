language: r
sudo: false
cache: packages

r:
  - devel

# OSes are defined in matrix.include hereunder
#os:
#  - linux
#  - osx

branches:
  only:
    - master
    - macosx

# Be strict when checking our package, but don't build the manual
warnings_are_errors: true
# Don't build vignettes on Mac OS X
matrix:
  include:
    - os: linux
      r_build_args: --no-manual --no-resave-data
      r_check_args: --no-manual --as-cran
    - os: osx
      r_build_args: --no-manual --no-build-vignettes --no-resave-data
      r_check_args: --no-manual --no-build-vignettes

# Email notifications
notifications:
  email:
    on_success: change
    on_failure: change

# covr is not a dependency for the package. So, install it explicitly
# RUnit required for Rd xref checking. Also force its install
r_binary_packages:
  - covr
  - RUnit

after_success:
  - Rscript -e 'covr::codecov()'
